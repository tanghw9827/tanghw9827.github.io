<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>控制基本原理</title>
    <link href="/2024/08/01/%E6%8E%A7%E5%88%B6%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86/"/>
    <url>/2024/08/01/%E6%8E%A7%E5%88%B6%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86/</url>
    
    <content type="html"><![CDATA[<meta name="referrer" content="no-referrer"><h1 id="输入输出">1 输入输出</h1><p>控制模块的目标是基于规划好的轨迹和当前车辆状态，输出控制指令给车辆，为自动驾驶车辆提供舒适的驾驶体验。</p><figure><img src="/images/resized_control_module.png" alt="Fig 1 控制模块"><figcaption>Fig 1 控制模块</figcaption></figure><ul><li>输入：规划好的轨迹（planning）和当前车辆状态(localization &amp;&amp; chassis)</li><li>输出：油门、刹车及方向盘转角(canbus)</li></ul><h1 id="车辆模型">2 车辆模型</h1><h2 id="自行车运动学模型">2.1 自行车运动学模型</h2><p>在自行车模型中，左右两个前轮由点 A 点的一个单轮表示。类似地，后轮由点 B 点的一个后轮表示。运动学模型中的主要假设是点 A 和 B 点的速度方向分别位于前轮和后轮的方向上。</p><p>假设：</p><ul><li>车辆的运动被限制在XY平面内，即没有考虑“上升”和“下降”运动。</li><li>左右轮转向运动相同，左右轮合成一个轮子。</li><li>忽略车轮的侧偏角，A点和B点的速度方向分别位于前轮和后轮的方向上。</li><li>忽略负载转移带来的质心位置变化。</li><li>车辆是刚性车身。</li></ul><figure><img src="/images/resized_Bicycle_KInematics.png" alt="Fig 2 自行车运动学模型"><figcaption>Fig 2 自行车运动学模型</figcaption></figure><h3 id="符号定义">符号定义</h3><ul><li><span class="math inline">\(C\)</span>：车辆质心</li><li><span class="math inline">\(\gamma = \psi + \beta\)</span>：航向角（质心速度方向与大地坐标系<span class="math inline">\(\vec{X}\)</span>轴的夹角）</li><li><span class="math inline">\(\beta\)</span>：侧偏角（质心速度方向和车身纵轴的夹角）</li><li><span class="math inline">\(\psi\)</span>：横摆角（车身轴线与大地坐标系<span class="math inline">\(\vec{X}\)</span>轴的夹角）</li><li><span class="math inline">\(\dot{\psi} = \frac{V}{R}\)</span>：低速情况下，假设<span class="math inline">\(R\)</span>变化缓慢</li></ul><p>这里假设相互作用的前后轮的侧偏角 <span class="math inline">\(\beta_f\)</span> 和 <span class="math inline">\(\beta_r\)</span> 都为0，对于车辆的低速运动（例如，速度小于5 m/s），这是一个合理的假设。在低速行驶时，轮胎产生的侧向力很小，两个轮胎的总侧向力是 <span class="math inline">\(\frac{mV^2}{R}\)</span>，此时前后轮的侧偏角可以近似为0（侧向力的大小与侧偏角近似成比例关系）。</p><h3 id="运动学方程">运动学方程</h3><p>AB点运动学模型的方程，可以得出：</p><p><span class="math display">\[\dot{X} = V \cos(\psi + \beta)\]</span></p><p><span class="math display">\[\dot{Y} = V \sin(\psi + \beta)\]</span></p><p><span class="math display">\[\dot{\psi} = \frac{V \cos(\beta)}{l_r + l_f} (\tan(\delta_f) - \tan(\delta_r))\]</span></p><h3 id="阿克曼转向车辆模型">阿克曼转向车辆模型</h3><p>实际应用时，一般会使用后轴中心的运动学模型（B点），即阿克曼转向车辆模型。</p><figure><img src="/images/resized_Ackerman_steering_model.png" alt="Fig 3 阿克曼转向车辆模型"><figcaption>Fig 3 阿克曼转向车辆模型</figcaption></figure><p>假定 <span class="math inline">\(\beta = 0\)</span>， <span class="math inline">\(\delta_r = 0\)</span>，<span class="math inline">\(\delta\)</span>为前轮转角，得：</p><p><span class="math display">\[\dot{X} = V \cos(\psi)\]</span></p><p><span class="math display">\[\dot{Y} = V \sin(\psi)\]</span></p><p><span class="math display">\[\dot{\psi} = \frac{V}{l_r} \tan(\delta_f)\]</span></p><h2 id="车辆二自由度动力学模型">2.2 车辆二自由度动力学模型</h2><p>在更高的车速下，不能再假设每个车轮的速度方向都在车轮的方向上，而是需要考虑轮胎的侧向力。轮胎的侧偏角定义为轮胎方向与车轮速度矢量方向之间的夹角。</p><figure><img src="/images/resized_slip_angle.png" alt="Fig 4 侧偏角"><figcaption>Fig 4 侧偏角</figcaption></figure><p>假设：</p><ul><li>车辆的运动被限制在XY平面内，即没有考虑“上升”和“下降”运动。</li><li>车轮的转向运动相同，车轮合成一个轮子。</li><li>车辆是刚性车身。</li><li>忽略负载转移带来的质心位置变化。</li><li>汽车纵向速度不变，即：<span class="math inline">\(V_y = C\)</span>。</li><li>忽略转向系统的影响，直接以前轮转角作为输入。</li><li>汽车横向加速度满足：<span class="math inline">\(a_y \leq 0.4g\)</span>，实验结果表明，对于小的侧偏角。此时轮胎侧偏力与侧偏角近似成正比。</li></ul><p>在上述假设下，汽车被简化为只有侧向和横摆两个自由度的两轮汽车模型。</p><figure><img src="/images/resized_Dynamic_Bicycle_Model.png" alt="Fig 5 车辆二自由度动力学模型"><figcaption>Fig 5 车辆二自由度动力学模型</figcaption></figure><p>由于质心侧偏角远小于车辆航向角和横摆角，在实际应用中可以认为航向角与横摆角相等,受力分析可以得到： <span class="math display">\[(F_{yf} \cos(\delta) - F_{xf} \sin(\delta)) + F_{yr} = m(\dot{v_y} + v_x \dot{\psi})\]</span></p><p><span class="math display">\[l_f (F_{yf} \cos(\delta) - F_{xf} \sin(\delta)) - l_r F_{yr} = I_z \ddot{\psi}\]</span> 这里横向加速度带有<span class="math inline">\(v_x\)</span>项，因为是矢量求导。</p><p>车辆的横向侧偏力可以写为</p><p><span class="math display">\[F_{yf} = 2 * c_f (\delta - \theta_{f}) \]</span></p><p><span class="math display">\[F_{yr} = 2 * c_r (-\theta_{r})\]</span></p><p><span class="math inline">\(c_f, c_r\)</span> 定义为侧偏刚度, 2 表示有两个轮子。</p><p>使用小角度假设， <span class="math display">\[\tan(\theta_{f}) = \frac{V_{yf} + l_{f}\dot{\psi}}{V_{x}}, \quad \tan(\theta_{r}) = \frac{V_{yr} - l_{r}\dot{\psi}}{V_{x}}\]</span></p><p><span class="math display">\[\theta_{f} = \frac{V_{yf} + l_{f}\dot{\psi}}{V_{x}}, \quad \theta_{r} = \frac{V_{yr} - l_{r}\dot{\psi}}{V_{x}}\]</span></p><p><span class="math display">\[\cos(\delta) \approx 1, \quad \sin(\delta) \approx 0\]</span></p><p>可以得到，</p><p><span class="math display">\[\begin{bmatrix}\dot{v}_y \\\ddot{\psi}\end{bmatrix}=\begin{bmatrix}-\frac{2c_f + 2c_r}{mv_x} &amp; \frac{2l_r c_r - 2l_f c_f}{mv_x} - v_x \\\frac{2l_r c_r - 2l_f c_f}{I_z v_x} &amp; -\frac{2l_f^2 c_f + 2l_r^2 c_r}{I_z v_x}\end{bmatrix}\begin{bmatrix}v_y \\\dot{\psi}\end{bmatrix}+\begin{bmatrix}\frac{2c_f}{m} \\\frac{2l_f c_f}{I_z}\end{bmatrix}\delta\]</span></p><p>定义误差：</p><p><span class="math display">\[\dot{\psi} = \frac{V_{x}}{R}\]</span></p><p><span class="math display">\[\ddot{e_{1}} = \ddot{y} + V_{x}\dot{\psi} - \frac{V_{x}^2}{R}\]</span></p><p><span class="math display">\[e_{2} = \psi - \psi_{des}\]</span></p><p>其中，<span class="math inline">\(e_1\)</span>为横向位置误差，<span class="math inline">\(e_2\)</span>为航向角误差。</p><p><span class="math display">\[\dot{x} = Ax + Bu + C\psi_{des}\]</span></p><p><span class="math display">\[X = \begin{bmatrix} e_1 &amp; e_2 &amp; \dot{e}_1 &amp; \dot{e}_2 \end{bmatrix}^T, \quad u = \delta\]</span></p><p><span class="math display">\[A = \begin{bmatrix}0 &amp; 1 &amp; 0 &amp; 0 \\0 &amp; -\frac{2c_f+2c_r}{mV_x} &amp; \frac{2c_f+2c_r}{m} &amp; -\frac{2c_f\ell_f - 2c_r\ell_r}{mV_x} \\0 &amp; 0 &amp; 0 &amp; 1 \\0 &amp; \frac{2c_f\ell_f - 2c_r\ell_r}{I_zV_x} &amp; -\frac{2c_f\ell_f - 2c_r\ell_r}{I_z} &amp; -\frac{2c_f\ell_f^2 + 2c_r\ell_r^2}{I_zV_x}\end{bmatrix}\]</span></p><p><span class="math display">\[B = \begin{bmatrix}0 \\\frac{2c_f}{m} \\0 \\\frac{2c_f\ell_f}{I_z}\end{bmatrix} \delta, \quadC = \begin{bmatrix}0 \\\frac{-2c_f\ell_f + 2c_r\ell_r - V_x}{mV_x} \\0 \\-\frac{2c_f\ell_f^2 + 2c_r\ell_r^2}{I_zV_x}\end{bmatrix}\]</span></p><p>综上，车辆二自由度动力学模型可以写为：</p><p><span class="math display">\[\frac{d}{dt} \begin{bmatrix}e_1 \\\dot{e}_1 \\e_2 \\\dot{e}_2\end{bmatrix} = \begin{bmatrix}0 &amp; 1 &amp; 0 &amp; 0 \\0 &amp; -\frac{2c_f+2c_r}{mV_x} &amp; \frac{2c_f+2c_r}{m} &amp; -\frac{2c_f\ell_f - 2c_r\ell_r}{mV_x} \\0 &amp; 0 &amp; 0 &amp; 1 \\0 &amp; \frac{2c_f\ell_f - 2c_r\ell_r}{I_zV_x} &amp; -\frac{2c_f\ell_f - 2c_r\ell_r}{I_z} &amp; -\frac{2c_f\ell_f^2 + 2c_r\ell_r^2}{I_zV_x}\end{bmatrix}\begin{bmatrix}e_1 \\\dot{e}_1 \\e_2 \\\dot{e}_2\end{bmatrix}+\begin{bmatrix}0 \\\frac{2c_f}{m} \\0 \\\frac{2c_f\ell_f}{I_z}\end{bmatrix} \delta+\begin{bmatrix}0 \\\frac{-2c_f\ell_f + 2c_r\ell_r - V_x}{mV_x} \\0 \\-\frac{2c_f\ell_f^2 + 2c_r\ell_r^2}{I_zV_x}\end{bmatrix} \dot{\psi}_{des}\]</span></p>]]></content>
    
    
    <categories>
      
      <category>控制算法</category>
      
    </categories>
    
    
  </entry>
  
  
  
  
</search>
