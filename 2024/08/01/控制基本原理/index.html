<!DOCTYPE html><html lang="zh-CN" data-default-color-scheme="auto"><head><meta charset="UTF-8"><link rel="apple-touch-icon" sizes="76x76" href="/img/avatar.png"><link rel="icon" href="/img/avatar.png"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5,shrink-to-fit=no"><meta http-equiv="x-ua-compatible" content="ie=edge"><meta name="theme-color" content="#2f4154"><meta name="author" content="Harvey Tang"><meta name="keywords" content="C++, Autopilot, Planning, Control"><meta name="description" content="在本篇文章中，将首先介绍车辆自行车运动学模型和车辆二自由度动力学模型，讲解车辆的运动学参数标定方法，然后介绍Pure pursuit、Stanley Steering、PID、LQR、MPC等控制算法的基本原理，对实车部署MPC算法的调参过程进行说明，最后介绍实车部署过程中遇到的问题与解决方法。"><meta property="og:type" content="article"><meta property="og:title" content="控制基本原理"><meta property="og:url" content="https://tanghw9827.github.io/2024/08/01/%E6%8E%A7%E5%88%B6%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86/index.html"><meta property="og:site_name" content="Harvey"><meta property="og:description" content="在本篇文章中，将首先介绍车辆自行车运动学模型和车辆二自由度动力学模型，讲解车辆的运动学参数标定方法，然后介绍Pure pursuit、Stanley Steering、PID、LQR、MPC等控制算法的基本原理，对实车部署MPC算法的调参过程进行说明，最后介绍实车部署过程中遇到的问题与解决方法。"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://tanghw9827.github.io/img/%E6%8E%A7%E5%88%B6%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86.png"><meta property="article:published_time" content="2024-07-31T16:00:00.000Z"><meta property="article:modified_time" content="2024-08-05T07:07:13.099Z"><meta property="article:author" content="Harvey Tang"><meta property="article:tag" content="C++, Autopilot, Planning, Control"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image" content="https://tanghw9827.github.io/img/%E6%8E%A7%E5%88%B6%E5%9F%BA%E6%9C%AC%E5%8E%9F%E7%90%86.png"><title>控制基本原理 - Harvey</title><link rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css"><link rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><link rel="stylesheet" href="//at.alicdn.com/t/c/font_1749284_5i9bdhy70f8.css"><link rel="stylesheet" href="//at.alicdn.com/t/c/font_1736178_k526ubmyhba.css"><link rel="stylesheet" href="/css/main.css"><link id="highlight-css" rel="stylesheet" href="/css/highlight.css"><link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css"><script id="fluid-configs">var Fluid=window.Fluid||{};Fluid.ctx=Object.assign({},Fluid.ctx);var CONFIG={hostname:"tanghw9827.github.io",root:"/",version:"1.9.8",typing:{enable:!0,typeSpeed:70,cursorChar:"_",loop:!1,scope:[]},anchorjs:{enable:!0,element:"h1,h2,h3,h4,h5,h6",placement:"left",visible:"hover",icon:""},progressbar:{enable:!0,height_px:3,color:"#29d",options:{showSpinner:!1,trickleSpeed:100}},code_language:{enable:!0,default:"TEXT"},copy_btn:!0,image_caption:{enable:!0},image_zoom:{enable:!0,img_url_replace:["",""]},toc:{enable:!0,placement:"right",headingSelector:"h1,h2,h3,h4,h5,h6",collapseDepth:0},lazyload:{enable:!0,loading_img:"/img/loading.gif",onlypost:!1,offset_factor:2},web_analytics:{enable:!1,follow_dnt:!0,baidu:null,google:{measurement_id:null},tencent:{sid:null,cid:null},leancloud:{app_id:null,app_key:null,server_url:null,path:"window.location.pathname",ignore_local:!1},umami:{src:null,website_id:null,domains:null,start_time:"2024-01-01T00:00:00.000Z",token:null,api_server:null}},search_path:"/local-search.xml",include_content_in_search:!0};if(CONFIG.web_analytics.follow_dnt){var dntVal=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack;Fluid.ctx.dnt=dntVal&&(dntVal.startsWith("1")||dntVal.startsWith("yes")||dntVal.startsWith("on"))}</script><script src="/js/utils.js"></script><script src="/js/color-schema.js"></script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"><meta name="generator" content="Hexo 7.3.0"></head><body><header><div class="header-inner" style="height:70vh"><nav id="navbar" class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar"><div class="container"><a class="navbar-brand" href="/"><strong>Harvey Tang</strong> </a><button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><div class="animated-icon"><span></span><span></span><span></span></div></button><div class="collapse navbar-collapse" id="navbarSupportedContent"><ul class="navbar-nav ml-auto text-center"><li class="nav-item"><a class="nav-link" href="/" target="_self"><i class="iconfont icon-home-fill"></i> <span>首页</span></a></li><li class="nav-item"><a class="nav-link" href="/archives/" target="_self"><i class="iconfont icon-archive-fill"></i> <span>归档</span></a></li><li class="nav-item"><a class="nav-link" href="/categories/" target="_self"><i class="iconfont icon-category-fill"></i> <span>分类</span></a></li><li class="nav-item"><a class="nav-link" href="/about/" target="_self"><i class="iconfont icon-user-fill"></i> <span>关于</span></a></li><li class="nav-item" id="search-btn"><a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search"><i class="iconfont icon-search"></i></a></li><li class="nav-item" id="color-toggle-btn"><a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle"><i class="iconfont icon-dark" id="color-toggle-icon"></i></a></li></ul></div></div></nav><div id="banner" class="banner" parallax="true" style="background:url(/img/default.png) no-repeat center center;background-size:cover"><div class="full-bg-img"><div class="mask flex-center" style="background-color:rgba(0,0,0,.3)"><div class="banner-text text-center fade-in-up"><div class="h2"><span id="subtitle" data-typed-text="控制基本原理"></span></div><div class="mt-3"><span class="post-meta"><i class="iconfont icon-date-fill" aria-hidden="true"></i> <time datetime="2024-08-01 00:00" pubdate>2024年8月1日 凌晨</time></span></div><div class="mt-1"><span class="post-meta mr-2"><i class="iconfont icon-chart"></i> 1.4k 字 </span><span class="post-meta mr-2"><i class="iconfont icon-clock-fill"></i> 12 分钟</span></div></div></div></div></div></div></header><main><div class="container-fluid nopadding-x"><div class="row nomargin-x"><div class="side-col d-none d-lg-block col-lg-2"></div><div class="col-lg-8 nopadding-x-md"><div class="container nopadding-x-md" id="board-ctn"><div id="board"><article class="post-content mx-auto"><h1 id="seo-header"><img src="/img/default.png" srcset="/img/loading.gif" lazyload alt="Post Image" style="width:20px;height:20px;margin-right:10px"> 控制基本原理</h1><div class="markdown-body"><meta name="referrer" content="no-referrer"><h1 id="输入输出">1 输入输出</h1><p>控制模块的目标是基于规划好的轨迹和当前车辆状态，输出控制指令给车辆，为自动驾驶车辆提供舒适的驾驶体验。</p><p><img src="/images/resized_control_module.png" srcset="/img/loading.gif" lazyload alt="Fig 1 控制模块" style="width:60%;height:auto"></p><ul><li>输入：规划好的轨迹（planning）和当前车辆状态(localization &amp;&amp; chassis)</li><li>输出：油门、刹车及方向盘转角(canbus)</li></ul><h1 id="车辆模型">2 车辆模型</h1><h2 id="自行车运动学模型">2.1 自行车运动学模型</h2><p>在自行车模型中，左右两个前轮由点 A 点的一个单轮表示。类似地，后轮由点 B 点的一个后轮表示。运动学模型中的主要假设是点 A 和 B 点的速度方向分别位于前轮和后轮的方向上。</p><p>假设：</p><ul><li>车辆的运动被限制在XY平面内，即没有考虑“上升”和“下降”运动。</li><li>左右轮转向运动相同，左右轮合成一个轮子。</li><li>忽略车轮的侧偏角，A点和B点的速度方向分别位于前轮和后轮的方向上。</li><li>忽略负载转移带来的质心位置变化。</li><li>车辆是刚性车身。</li></ul><p><img src="/images/resized_Bicycle_KInematics.png" srcset="/img/loading.gif" lazyload alt="Fig 2 自行车运动学模型" style="width:60%;height:auto"></p><h3 id="符号定义">符号定义</h3><ul><li><span class="math inline">\(C\)</span>：车辆质心</li><li><span class="math inline">\(\gamma = \psi + \beta\)</span>：航向角（质心速度方向与大地坐标系<span class="math inline">\(\vec{X}\)</span>轴的夹角）</li><li><span class="math inline">\(\beta\)</span>：侧偏角（质心速度方向和车身纵轴的夹角）</li><li><span class="math inline">\(\psi\)</span>：横摆角（车身轴线与大地坐标系<span class="math inline">\(\vec{X}\)</span>轴的夹角）</li><li><span class="math inline">\(\dot{\psi} = \frac{V}{R}\)</span>：低速情况下，假设<span class="math inline">\(R\)</span>变化缓慢</li></ul><p>这里假设相互作用的前后轮的侧偏角 <span class="math inline">\(\beta_f\)</span> 和 <span class="math inline">\(\beta_r\)</span> 都为0，对于车辆的低速运动（例如，速度小于5 m/s），这是一个合理的假设。在低速行驶时，轮胎产生的侧向力很小，两个轮胎的总侧向力是 <span class="math inline">\(\frac{mV^2}{R}\)</span>，此时前后轮的侧偏角可以近似为0（侧向力的大小与侧偏角近似成比例关系）。</p><h3 id="运动学方程">运动学方程</h3><p>AB点运动学模型的方程，可以得出：</p><p><span class="math display">\[ \dot{X} = V \cos(\psi + \beta) \]</span></p><p><span class="math display">\[ \dot{Y} = V \sin(\psi + \beta) \]</span></p><p><span class="math display">\[ \dot{\psi} = \frac{V \cos(\beta)}{l_r + l_f} (\tan(\delta_f) - \tan(\delta_r)) \]</span></p><h3 id="阿克曼转向车辆模型">阿克曼转向车辆模型</h3><p>实际应用时，一般会使用后轴中心的运动学模型（B点），即阿克曼转向车辆模型。</p><p><img src="/images/resized_Ackerman_steering_model.png" srcset="/img/loading.gif" lazyload alt="Fig 3 阿克曼转向车辆模型" style="width:60%;height:auto"></p><p>假定 <span class="math inline">\(\beta = 0\)</span>， <span class="math inline">\(\delta_r = 0\)</span>，<span class="math inline">\(\delta\)</span>为前轮转角，得：</p><p><span class="math display">\[ \dot{X} = V \cos(\psi) \]</span></p><p><span class="math display">\[ \dot{Y} = V \sin(\psi) \]</span></p><p><span class="math display">\[ \dot{\psi} = \frac{V}{L} \tan(\delta_f) \]</span></p><h2 id="车辆二自由度动力学模型">2.2 车辆二自由度动力学模型</h2><p>在更高的车速下，不能再假设每个车轮的速度方向都在车轮的方向上，而是需要考虑轮胎的侧向力。轮胎的侧偏角定义为轮胎方向与车轮速度矢量方向之间的夹角。</p><p><img src="/images/resized_slip_angle.png" srcset="/img/loading.gif" lazyload alt="Fig 4 侧偏角" style="width:60%;height:auto"></p><p>假设：</p><ul><li>车辆的运动被限制在XY平面内，即没有考虑“上升”和“下降”运动。</li><li>车轮的转向运动相同，车轮合成一个轮子。</li><li>车辆是刚性车身。</li><li>忽略负载转移带来的质心位置变化。</li><li>汽车纵向速度不变，即：<span class="math inline">\(V_y = C\)</span>。</li><li>忽略转向系统的影响，直接以前轮转角作为输入。</li><li>汽车横向加速度满足：<span class="math inline">\(a_y \leq 0.4g\)</span>，实验结果表明，对于小的侧偏角。此时轮胎侧偏力与侧偏角近似成正比。</li></ul><p>在上述假设下，汽车被简化为只有侧向和横摆两个自由度的两轮汽车模型。</p><p><img src="/images/resized_Dynamic_Bicycle_Model.png" srcset="/img/loading.gif" lazyload alt="Fig 5 车辆二自由度动力学模型" style="width:60%;height:auto"></p><p>由于质心侧偏角远小于车辆航向角和横摆角，在实际应用中可以认为航向角与横摆角相等,受力分析可以得到： <span class="math display">\[ (F_{yf} \cos(\delta) - F_{xf} \sin(\delta)) + F_{yr} = m(\dot{v_y} + v_x \dot{\psi}) \]</span></p><p><span class="math display">\[ l_f (F_{yf} \cos(\delta) - F_{xf} \sin(\delta)) - l_r F_{yr} = I_z \ddot{\psi} \]</span> 这里横向加速度带有<span class="math inline">\(v_x\)</span>项，因为是矢量求导。</p><p>车辆的横向侧偏力可以写为</p><p><span class="math display">\[ F_{yf} = 2 * c_f (\delta - \theta_{f}) \]</span></p><p><span class="math display">\[ F_{yr} = 2 * c_r (-\theta_{r}) \]</span></p><p><span class="math inline">\(c_f, c_r\)</span> 定义为侧偏刚度, 2 表示有两个轮子。</p><p>使用小角度假设， <span class="math display">\[ \tan(\theta_{f}) = \frac{V_{yf} + l_{f}\dot{\psi}}{V_{x}}, \quad \tan(\theta_{r}) = \frac{V_{yr} - l_{r}\dot{\psi}}{V_{x}} \]</span></p><p><span class="math display">\[ \theta_{f} = \frac{V_{yf} + l_{f}\dot{\psi}}{V_{x}}, \quad \theta_{r} = \frac{V_{yr} - l_{r}\dot{\psi}}{V_{x}} \]</span></p><p><span class="math display">\[ \cos(\delta) \approx 1, \quad \sin(\delta) \approx 0 \]</span></p><p>可以得到，</p><p><span class="math display">\[ \begin{bmatrix} \dot{v}_y \\ \ddot{\psi} \end{bmatrix} = \begin{bmatrix} -\frac{2c_f + 2c_r}{mv_x} &amp; \frac{2l_r c_r - 2l_f c_f}{mv_x} - v_x \\ \frac{2l_r c_r - 2l_f c_f}{I_z v_x} &amp; -\frac{2l_f^2 c_f + 2l_r^2 c_r}{I_z v_x} \end{bmatrix} \begin{bmatrix} v_y \\ \dot{\psi} \end{bmatrix} + \begin{bmatrix} \frac{2c_f}{m} \\ \frac{2l_f c_f}{I_z} \end{bmatrix} \delta \]</span></p><p>定义误差：</p><p><span class="math display">\[ \dot{\psi} = \frac{V_{x}}{R} \]</span></p><p><span class="math display">\[ \ddot{e_{1}} = \ddot{y} + V_{x}\dot{\psi} - \frac{V_{x}^2}{R} \]</span></p><p><span class="math display">\[ e_{2} = \psi - \psi_{des} \]</span></p><p>其中，<span class="math inline">\(e_1\)</span>为横向位置误差，<span class="math inline">\(e_2\)</span>为航向角误差。</p><p><span class="math display">\[ \dot{x} = Ax + Bu + C\psi_{des} \]</span></p><p><span class="math display">\[ X = \begin{bmatrix} e_1 &amp; e_2 &amp; \dot{e}_1 &amp; \dot{e}_2 \end{bmatrix}^T, \quad u = \delta \]</span></p><p><span class="math display">\[ A = \begin{bmatrix} 0 &amp; 1 &amp; 0 &amp; 0 \\ 0 &amp; -\frac{2c_f+2c_r}{mV_x} &amp; \frac{2c_f+2c_r}{m} &amp; -\frac{2c_f\ell_f - 2c_r\ell_r}{mV_x} \\ 0 &amp; 0 &amp; 0 &amp; 1 \\ 0 &amp; \frac{2c_f\ell_f - 2c_r\ell_r}{I_zV_x} &amp; -\frac{2c_f\ell_f - 2c_r\ell_r}{I_z} &amp; -\frac{2c_f\ell_f^2 + 2c_r\ell_r^2}{I_zV_x} \end{bmatrix} \]</span></p><p><span class="math display">\[ B = \begin{bmatrix} 0 \\ \frac{2c_f}{m} \\ 0 \\ \frac{2c_f\ell_f}{I_z} \end{bmatrix} \delta , \quad C = \begin{bmatrix} 0 \\ \frac{-2c_f\ell_f + 2c_r\ell_r - V_x}{mV_x} \\ 0 \\ -\frac{2c_f\ell_f^2 + 2c_r\ell_r^2}{I_zV_x} \end{bmatrix} \]</span></p><p>综上，车辆二自由度动力学模型可以写为：</p><p><span class="math display">\[ \frac{d}{dt} \begin{bmatrix} e_1 \\ \dot{e}_1 \\ e_2 \\ \dot{e}_2 \end{bmatrix} = \begin{bmatrix} 0 &amp; 1 &amp; 0 &amp; 0 \\ 0 &amp; -\frac{2c_f+2c_r}{mV_x} &amp; \frac{2c_f+2c_r}{m} &amp; -\frac{2c_f\ell_f - 2c_r\ell_r}{mV_x} \\ 0 &amp; 0 &amp; 0 &amp; 1 \\ 0 &amp; \frac{2c_f\ell_f - 2c_r\ell_r}{I_zV_x} &amp; -\frac{2c_f\ell_f - 2c_r\ell_r}{I_z} &amp; -\frac{2c_f\ell_f^2 + 2c_r\ell_r^2}{I_zV_x} \end{bmatrix} \begin{bmatrix} e_1 \\ \dot{e}_1 \\ e_2 \\ \dot{e}_2 \end{bmatrix} + \begin{bmatrix} 0 \\ \frac{2c_f}{m} \\ 0 \\ \frac{2c_f\ell_f}{I_z} \end{bmatrix} \delta + \begin{bmatrix} 0 \\ \frac{-2c_f\ell_f + 2c_r\ell_r - V_x}{mV_x} \\ 0 \\ -\frac{2c_f\ell_f^2 + 2c_r\ell_r^2}{I_zV_x} \end{bmatrix} \dot{\psi}_{des} \]</span></p><h2 id="运动学和动力学参数标定">2.2 运动学和动力学参数标定</h2></div><hr><div><div class="post-metas my-3"><div class="post-meta mr-3 d-flex align-items-center"><i class="iconfont icon-category"></i> <span class="category-chains"><span class="category-chain"><a href="/categories/%E6%8E%A7%E5%88%B6%E7%AE%97%E6%B3%95/" class="category-chain-item">控制算法</a></span></span></div></div><div class="license-box my-3"><div class="license-title"><div>控制基本原理</div><div>https://tanghw9827.github.io/2024/08/01/控制基本原理/</div></div><div class="license-meta"><div class="license-meta-item"><div>作者</div><div>Harvey Tang</div></div><div class="license-meta-item license-meta-date"><div>发布于</div><div>2024年8月1日</div></div><div class="license-meta-item"><div>许可协议</div><div><a class="print-no-link" target="_blank" href="https://creativecommons.org/licenses/by/4.0/"><span class="hint--top hint--rounded" aria-label="BY - 署名"><i class="iconfont icon-cc-by"></i></span></a></div></div></div><div class="license-icon iconfont"></div></div><div class="post-prevnext my-3"><article class="post-prev col-6"><a href="/2024/08/02/%E8%A7%84%E5%88%92%E7%AE%97%E6%B3%95%E4%B8%B2%E8%AE%B2/" title="规划算法串讲"><i class="iconfont icon-arrowleft"></i> <span class="hidden-mobile">规划算法串讲</span> <span class="visible-mobile">上一篇</span></a></article><article class="post-next col-6"></article></div></div><article id="comments" lazyload><div id="valine"></div><script type="text/javascript">Fluid.utils.loadComments("#valine",(function(){Fluid.utils.createScript("https://lib.baomitu.com/valine/1.5.1/Valine.min.js",(function(){var n=Object.assign({appId:"8m9N9Kn5CK6K1op9xdv7Ij9V-MdYXbMMI",appKey:"FVHAVAwSHL9MNMaYrhu3uMfm",path:"window.location.pathname",placeholder:"欢迎留言哦！请保持文明用语😊",avatar:"mp",meta:["nick","mail","link"],requiredFields:["nick","mail"],pageSize:10,lang:"zh-CN",highlight:!0,recordIP:!0,serverURLs:"https://8m9n9kn5.api.lncldglobal.com",emojiCDN:"https://cdn.jsdelivr.net/npm/@valine/emojis@latest",emojiMaps:{smile:"smile.png",grin:"grin.png",joy:"joy.png",rofl:"rofl.png",stuck_out_tongue:"stuck_out_tongue.png",stuck_out_tongue_winking_eye:"stuck_out_tongue_winking_eye.png"},enableQQ:!0},{el:"#valine",path:window.location.pathname});new Valine(n),Fluid.utils.waitElementVisible("#valine .vcontent",()=>{var n="#valine .vcontent img:not(.vemoji)";Fluid.plugins.imageCaption(n),Fluid.plugins.fancyBox(n)})}))}))</script><noscript>Please enable JavaScript to view the comments</noscript></article></article></div></div></div><div class="side-col d-none d-lg-block col-lg-2"><aside class="sidebar" style="margin-left:-1rem"><div id="toc"><p class="toc-header"><i class="iconfont icon-list"></i> <span>目录</span></p><div class="toc-body" id="toc-body"></div></div></aside></div></div></div><a id="scroll-top-button" aria-label="TOP" href="#" role="button"><i class="iconfont icon-arrowup" aria-hidden="true"></i></a><div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable modal-lg" role="document"><div class="modal-content"><div class="modal-header text-center"><h4 class="modal-title w-100 font-weight-bold">搜索</h4><button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button></div><div class="modal-body mx-3"><div class="md-form mb-5"><input type="text" id="local-search-input" class="form-control validate"> <label data-error="x" data-success="v" for="local-search-input">关键词</label></div><div class="list-group" id="local-search-result"></div></div></div></div></div></main><footer><div class="footer-inner"><div class="footer-content"><a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a></div></div></footer><script src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js"></script><link rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css"><script>NProgress.configure({showSpinner:!1,trickleSpeed:100}),NProgress.start(),window.addEventListener("load",(function(){NProgress.done()}))</script><script src="https://lib.baomitu.com/jquery/3.6.4/jquery.min.js"></script><script src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js"></script><script src="/js/events.js"></script><script src="/js/plugins.js"></script><script src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js"></script><script>!function(t,e){var i=Fluid.plugins.typing,n=e.getElementById("subtitle");n&&i&&i(n.getAttribute("data-typed-text"))}(window,document)</script><script src="/js/img-lazyload.js"></script><script>Fluid.utils.createScript("https://lib.baomitu.com/tocbot/4.20.1/tocbot.min.js",(function(){var t=jQuery("#toc");if(0!==t.length&&window.tocbot){var i=jQuery("#board-ctn").offset().top;window.tocbot.init(Object.assign({tocSelector:"#toc-body",contentSelector:".markdown-body",linkClass:"tocbot-link",activeLinkClass:"tocbot-active-link",listClass:"tocbot-list",isCollapsedClass:"tocbot-is-collapsed",collapsibleClass:"tocbot-is-collapsible",scrollSmooth:!0,includeTitleTags:!0,headingsOffset:-i},CONFIG.toc)),t.find(".toc-list-item").length>0&&t.css("visibility","visible"),Fluid.events.registerRefreshCallback((function(){if("tocbot"in window){tocbot.refresh();var t=jQuery("#toc");if(0===t.length||!tocbot)return;t.find(".toc-list-item").length>0&&t.css("visibility","visible")}}))}}))</script><script src="https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js"></script><script>Fluid.plugins.codeWidget()</script><script>Fluid.utils.createScript("https://lib.baomitu.com/anchor-js/5.0.0/anchor.min.js",(function(){window.anchors.options={placement:CONFIG.anchorjs.placement,visible:CONFIG.anchorjs.visible},CONFIG.anchorjs.icon&&(window.anchors.options.icon=CONFIG.anchorjs.icon);var n=(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","),o=[];for(var s of n)o.push(".markdown-body > "+s.trim());"left"===CONFIG.anchorjs.placement&&(window.anchors.options.class="anchorjs-link-left"),window.anchors.add(o.join(", ")),Fluid.events.registerRefreshCallback((function(){if("anchors"in window){anchors.removeAll();var n=(CONFIG.anchorjs.element||"h1,h2,h3,h4,h5,h6").split(","),o=[];for(var s of n)o.push(".markdown-body > "+s.trim());"left"===CONFIG.anchorjs.placement&&(anchors.options.class="anchorjs-link-left"),anchors.add(o.join(", "))}}))}))</script><script>Fluid.utils.createScript("https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js",(function(){Fluid.plugins.fancyBox()}))</script><script>Fluid.plugins.imageCaption()</script><script>window.MathJax?(MathJax.startup.document.state(0),MathJax.texReset(),MathJax.typeset(),MathJax.typesetPromise()):window.MathJax={tex:{inlineMath:{"[+]":[["$","$"]]}},loader:{load:["ui/lazy"]},options:{renderActions:{insertedScript:[200,()=>{document.querySelectorAll("mjx-container").forEach(t=>{let e=t.parentNode;"li"===e.nodeName.toLowerCase()&&e.parentNode.classList.add("has-jax")})},"",!1]}}},Fluid.events.registerRefreshCallback((function(){"MathJax"in window&&MathJax.startup.document&&"function"==typeof MathJax.startup.document.state&&(MathJax.startup.document.state(0),MathJax.texReset(),MathJax.typeset(),MathJax.typesetPromise())}))</script><script src="https://lib.baomitu.com/mathjax/3.2.2/es5/tex-mml-chtml.js"></script><script src="/js/local-search.js"></script><script src="/js/boot.js"></script><noscript><div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div></noscript></body></html>